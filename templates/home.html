{% extends "base.html" %}
{% block body %}
  <!-- Main content -->
  <div class="tabs-container" id="tabs-container">
    <!-- Tab Buttons -->
    <div class="tab-buttons-container" id="tab-buttons-container">
      <div class="tab-button train-button"
           id="train-btn"
           onclick="openTab('train')">
        <span class="tab-icon">‚öôÔ∏è</span> <!-- Gear Icon -->
        Train
      </div>
      <div class="tab-button test-button"
           id="test-btn"
           onclick="openTab('test')">
        <span class="tab-icon">üî¨</span> <!-- Microscope Icon -->
        Test
      </div>
    </div>
    <!-- Content Area -->
    <div class="content-container">
      <!-- Train Tab Content -->
      <div id="train" class="tab-content train-tab">
        <div class="card">
          <h2 class="card-title">Upload Training Data</h2>
          <div class="form-group">
            <label for="train-file-upload">Upload (Folder):</label>
            <div class="file-upload">
              <form action="{{ url_for('upload_folder') }}"
                    method="post"
                    enctype="multipart/form-data">
                <input type="file"
                       id="train-zip-input"
                       name="train_zip"
                       accept=".zip"
                       onchange="updateFileLabel('train-zip-input', 'train-zip-label'); this.form.submit();">
                <button type="button"
                        class="btn"
                        onclick="document.getElementById('train-zip-input').click();">Choose Zip File</button>
                <span class="file-label" id="train-zip-label">
                  {% set messages = get_flashed_messages(category_filter=["image_count"]) %}
                  {% if messages %}
                    {% for msg in messages %}{{ msg }}{% endfor %}
                  {% else %}
                    No zip file chosen
                  {% endif %}
                </span>
              </form>
              <form action="{{ url_for('delete_upload') }}" method="post">
                {% if messages %}<button type="submit" class="btn margin">Delete upload</button>{% endif %}
              </form>
            </div>
          </div>
          <span class="file-label" id="train-folder-label">
            {% set messages = get_flashed_messages(category_filter=["error"]) %}
            {% for msg in messages %}{{ msg }}{% endfor %}
          </span>
        </div>
        <div class="card">
          <h2 class="card-title">Model Selection</h2>
          <div class="form-group">
            <label for="train-model-select">Select Model:</label>
            <select id="train-model-select">
              <option>Convolutional Neural Network (CNN)</option>
              <option>ResNet</option>
              <option>MobileNet</option>
            </select>
          </div>
        </div>
        <div class="card">
          <h2 class="card-title">CNN Hyperparameters</h2>
          <div class="form-row">
            <div class="form-col">
              <label for="epochs">Epochs:</label>
              <input type="number" id="epochs" value="10">
            </div>
            <div class="form-col">
              <label for="batch-size">Batch Size:</label>
              <input type="number" id="batch-size" value="32">
            </div>
            <div class="form-col">
              <label for="learning-rate">Learning Rate:</label>
              <input type="number" id="learning-rate" value="0.001" step="0.0001">
            </div>
            <div class="form-col">
              <label for="optimizer">Optimizer:</label>
              <select id="optimizer">
                <option>Adam</option>
                <option>SGD</option>
                <option>RMSprop</option>
              </select>
            </div>
            <div class="form-col">
              <label for="dropout-rate">Dropout Rate:</label>
              <input type="number"
                     id="dropout-rate"
                     value="0.5"
                     step="0.1"
                     min="0"
                     max="1">
            </div>
            <div class="form-col">
              <label for="conv-layers">Conv Layers:</label>
              <input type="number" id="conv-layers" value="3" min="1" max="10">
            </div>
          </div>
          <div class="form-group">
            <button class="btn run-btn">
              <span>‚ñ∂</span> Start Training
            </button>
          </div>
        </div>
        <div class="console">
          == Training Console ==
          <br>
          Awaiting training parameters...
        </div>
      </div>
      <!-- Test Tab Content -->
      <div id="test" class="tab-content test-tab">
        <div class="card">
          <h2 class="card-title">Upload Image to Test:</h2>
          <div class="form-group">
            <label for="test-file-upload">Upload Image:</label>
            <div class="file-upload">
              <input type="file"
                     id="test-file-input"
                     accept="image/*"
                     onchange="updateFileLabel('test-file-input', 'test-file-label')">
              <button class="btn"
                      onclick="document.getElementById('test-file-input').click();">Choose Image</button>
              <span class="file-label" id="test-file-label">No file chosen</span>
            </div>
          </div>
        </div>
        <div class="card">
          <h2 class="card-title">Select Model for Testing:</h2>
          <div class="form-group">
            <label for="test-model-select">Select Model:</label>
            <select id="test-model-select">
              <option>Convolutional Neural Network (CNN)</option>
              <option>ResNet</option>
              <option>MobileNet</option>
            </select>
          </div>
          <div class="form-group">
            <button class="btn run-btn">
              <span>‚ñ∂</span> Run Test
            </button>
          </div>
        </div>
        <div id="results-area" class="card">
          <h2 class="card-title">Test Results</h2>
          <p>Results will appear here after running a test.</p>
        </div>
      </div>
    </div>
  </div>
{% endblock body %}
